<h1 id="colormap"><a aria-hidden="true" class="anchor-heading" href="#colormap"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Colormap</h1>
<p>Maps value given color palette</p>
<h2 id="implementation"><a aria-hidden="true" class="anchor-heading" href="#implementation"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Implementation</h2>
<h3 id="colormap-1"><a aria-hidden="true" class="anchor-heading" href="#colormap-1"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>colormap</h3>
<pre><code>palette p: 256 x 3 (RGB8) array
factor f: [0, 1]

mapped_f = f * (256 - 1)
a = floor(f)
b = ceil(f)

# apply linear interpolation for rgb
c = mix(p[a], p[b], mapped_f - a)
</code></pre>
<h3 id="fragment-shader"><a aria-hidden="true" class="anchor-heading" href="#fragment-shader"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Fragment shader</h3>
<p>Substitude material diffuse <a href="/my-personal-knowledge-cache/notes/kfzM61y5Fcv6d0wygFgzS#phong-lighting-model">Phong lighting model</a></p>
<blockquote>
<p>Bind buffer</p>
</blockquote>
<pre><code>bind_vertex_attrib_array(shader_mesh,"Kd", vbo_V_diffuse, V_diffuse_vbo, dirty &#x26; MeshGL::DIRTY_DIFFUSE);
</code></pre>
<blockquote>
<p>Vertex shader (for interpolation)</p>
</blockquote>
<pre><code>Kdi = Kd;
</code></pre>
<blockquote>
<p>Fragment shader</p>
</blockquote>
<pre><code>vec4 color = vec4(lighting_factor * (Is + Id) + Ia + (1.0-lighting_factor) * vec3(Kdi),(Kai.a+Ksi.a+Kdi.a)/3);
</code></pre>