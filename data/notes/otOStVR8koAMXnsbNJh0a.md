> Reference: https://google.github.io/filament/Filament.html#lighting/imagebasedlights/processinglightprobes

## Primitives

**Environment mapping(reflection mapping)**: method for producing environment based reflections on surfaces of reflective objects

**Environment map**: image representation of the environment surrounding a point in a scene, can be further processed to shade object based on surrounding lighting conditions in image based lighting

**Cube (environment) map**: a type of environment map, a texture that contains 6 individual 2D textures that each form one side of a cube

**Image based lighting (IBL)**: a technique for environment based lighting that efficiently computes lighting while shading objects with the utilization of pre-processed environment map

**Incident light**: light falls on object's surface

**Irradiance**: the contribution of the whole environment light to a given point on the object's surface 

**Radiance**: the resulting light bouncing off of the object

## Image based lighting for physical based rendering

**Rendering equation**:

Outgoing radiance = incoming radiance + integration of the surface response for incident light from a single direction over entire hemisphere

**Bidirectional Reflectance Distribution Function (BRDF)** describe surface response of a standard function over two terms:
- diffuse component 
- specular component 

**Diffuse computation (invariant to view angle)**: irradiance map + spherical harmonics

Irradiance integral is precomputed using Lambertian BRDF and stored into a **cubemap**. It can be approximated using spherical harmonics decomposition for cheap runtime calculation

**Specular computation**: pre-filtered importance sampling + split-sum approximation

Radiance integral = [DFG1(n.dot(v), a) + DFG2(n.dot(v), a)] x LD(n, a)

where, n is surface normal vector, v is viewing vector, a relates to perceptual roughness

DFG1 and DFG2 can be pre-calculated in a 2D texture or analytically approximated at runtime (on android); LD can be stored in **mipmaped cubemaps** (more rough, more blur)

## Filament IBL Requirements

Indirect light reflection requires (log2(width) + 1) levels mip-mapped **cubemap** generated by cmgen, or prefiltered with [generatePrefilterMipmap (cpu)](https://github.com/google/filament/blob/main/filament/include/filament/Texture.h#L468) or [libibl (gpu)](https://github.com/google/filament/tree/main/libs/iblprefilter), with each cubemap encodes the irradiance for a roughness level
