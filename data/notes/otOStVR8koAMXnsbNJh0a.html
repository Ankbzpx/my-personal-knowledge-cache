<h1 id="image-based-lighting"><a aria-hidden="true" class="anchor-heading" href="#image-based-lighting"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Image Based Lighting</h1>
<blockquote>
<p>Reference: <a href="https://google.github.io/filament/Filament.html#lighting/imagebasedlights/processinglightprobes">https://google.github.io/filament/Filament.html#lighting/imagebasedlights/processinglightprobes</a></p>
</blockquote>
<h2 id="primitives"><a aria-hidden="true" class="anchor-heading" href="#primitives"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Primitives</h2>
<p><strong>Environment mapping(reflection mapping)</strong>: method for producing environment based reflections on surfaces of reflective objects</p>
<p><strong>Environment map</strong>: image representation of the environment surrounding a point in a scene, can be further processed to shade object based on surrounding lighting conditions in image based lighting</p>
<p><strong>Cube (environment) map</strong>: a type of environment map, a texture that contains 6 individual 2D textures that each form one side of a cube</p>
<p><strong>Image based lighting (IBL)</strong>: a technique for environment based lighting that efficiently computes lighting while shading objects with the utilization of pre-processed environment map</p>
<p><strong>Incident light</strong>: light falls on object's surface</p>
<p><strong>Irradiance</strong>: the contribution of the whole environment light to a given point on the object's surface </p>
<p><strong>Radiance</strong>: the resulting light bouncing off of the object</p>
<h2 id="image-based-lighting-for-physical-based-rendering"><a aria-hidden="true" class="anchor-heading" href="#image-based-lighting-for-physical-based-rendering"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Image based lighting for physical based rendering</h2>
<p><strong>Rendering equation</strong>:</p>
<p>Outgoing radiance = incoming radiance + integration of the surface response for incident light from a single direction over entire hemisphere</p>
<p><strong>Bidirectional Reflectance Distribution Function (BRDF)</strong> describe surface response of a standard function over two terms:</p>
<ul>
<li>diffuse component </li>
<li>specular component </li>
</ul>
<p><strong>Diffuse computation (invariant to view angle)</strong>: irradiance map + spherical harmonics</p>
<p>Irradiance integral is precomputed using Lambertian BRDF and stored into a <strong>cubemap</strong>. It can be approximated using spherical harmonics decomposition for cheap runtime calculation</p>
<p><strong>Specular computation</strong>: pre-filtered importance sampling + split-sum approximation</p>
<p>Radiance integral = [DFG1(n.dot(v), a) + DFG2(n.dot(v), a)] x LD(n, a)</p>
<p>where, n is surface normal vector, v is viewing vector, a relates to perceptual roughness</p>
<p>DFG1 and DFG2 can be pre-calculated in a 2D texture or analytically approximated at runtime (on android); LD can be stored in <strong>mipmaped cubemaps</strong> (more rough, more blur)</p>
<h2 id="filament-ibl-requirements"><a aria-hidden="true" class="anchor-heading" href="#filament-ibl-requirements"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Filament IBL Requirements</h2>
<p>Indirect light reflection requires (log2(width) + 1) levels mip-mapped <strong>cubemap</strong> generated by cmgen, or prefiltered with <a href="https://github.com/google/filament/blob/main/filament/include/filament/Texture.h#L468">generatePrefilterMipmap (cpu)</a> or <a href="https://github.com/google/filament/tree/main/libs/iblprefilter">libibl (gpu)</a>, with each cubemap encodes the irradiance for a roughness level</p>